<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>GIPHY</title>
</head>



<body>
<style>


h2 { 
	width: 250px;
	margin: 0;
}

#buttons-view {
	box-sizing: border-box;
	width: 100%;
	height: 50px;
	padding: 10px;
	border: 2px solid black;
	background-color: lightblue;
}

#giphy-view {
	box-sizing: border-box;
	width: 100%;
	padding: 10px;
	border: 2px solid black;
	background-color: lightblue;
	display: flex;
	flex-wrap: wrap;
	flex-direction: row;
}

#giphy-input {
	text-align: center;
}

img {
	width: 250px;
	height: 250px;
}

</style>

	<div class="container">
		<div id="buttons-view"></div>

		<br>

		<form id="giphy-form">
			<label>Add your meme</label>
			<input id="giphy-input" type="text">
			<input id="add-giphy" type="submit" value="add">
		</form> 
		
		<br>

			<div id="giphy-view"></div>

	
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<script type="text/javascript">

		var giphyContainer = ["pikachu", "squirtle", "charmander"];
		
			function displayGiphy() {
				var q = $(this).attr("data-name");
				var key = "fvnKnRa6RWrXg3jC8xiDFil6oMOzSGKB";
				var limit = "&limit= " + 10;
				var queryURL = "https://api.giphy.com/v1/gifs/search?q=" + q + "&api_key=" + key + limit;
				
				$.ajax({
					url: queryURL,
					method: "GET"
				}).then(function(response) {
					console.log(response);
					var gif = response.data;
					for (var i = 0; i < gif.length; i++) {
						
						
						var ratings = gif[i].rating;
						var animateURL = gif[i].images.original.url;
						var stillURL = gif[i].images.fixed_height_still.url;
						
						var gifDiv = $("<div>");
						var pRatings = $("<h2>").text("Ratings: " + ratings);
						var images = $("<img class='gif'>");
						
						gifDiv.append(pRatings, images);
						$("#giphy-view").append(gifDiv);
						
							images.attr("src", stillURL);
							images.attr("data-still", stillURL);
							images.attr("data-animate", animateURL);
							images.attr("data-state", "still");
							
							$(".gif").on("click", function() {
								var state = $(this).attr("data-state");
				
								if (state === "still") {
									$(this).attr("src", $(this).attr("data-animate"));
									$(this).attr("data-state", "animate");
								} 
								else {
									$(this).attr("src", $(this).attr("data-still"));
									$(this).attr("data-state", "still");
								}
							});
					}
				});

			}



			function renderButtons() {

			$("#buttons-view").empty();

			for (var i = 0; i < giphyContainer.length; i++) {
				var button = $("<button>");
				button.addClass("giphy");
				button.attr("data-name", giphyContainer[i]);
				button.text(giphyContainer[i]);
				$("#buttons-view").append(button);
				console.log(giphyContainer[i]);
				}
			}

			$("#add-giphy").on("click", function(event) {

				event.preventDefault();

				var giphy = $("#giphy-input").val().trim();
				giphyContainer.push(giphy);

				renderButtons();
			});
      $(document).on("click", ".giphy", displayGiphy);

			renderButtons();

		</script>	
	</div>
</body>
</html>