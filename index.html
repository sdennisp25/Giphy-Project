<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>GIPHY</title>
</head>



<body>


	<div class="container">
		<div id="buttons-view"></div>

		<br>

		<form id="giphy-form">
			<label>Add your meme</label>
			<input id="giphy-input" type="text">
			<input id="add-giphy" type="submit" value="add">
		</form> 
		
		<br>

		<div id="giphy-view"></div>

	
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<script type="text/javascript">
		var giphyContainer = [];
		

		function displayGiphy() {
			var giphy = $(this).attr("data-name");
			var key = "fvnKnRa6RWrXg3jC8xiDFil6oMOzSGKB";
			var limit = "&limit= " + 10;
			var q = $("#giphy-input").val().trim();
			var queryURL = "https://api.giphy.com/v1/gifs/search?q=" + q + "&api_key=" + key + limit;
			
			$.ajax({
				url: queryURL,
				method: "GET"
			}).then(function(response) {
				console.log(response);
				var gif = response.data;
				for (var i = 0; i < gif.length; i++) {
					
					var ratings = gif[i].rating;
					var pRatings = $("<h2>").text("Ratings: " + ratings);
					$("#giphy-view").append(pRatings);

					var images = gif[i].images.original.url;
					$("#giphy-view").append("<img src='" + images + "' style='height: 250px; width: 250px;'/>");

				}
			});

		}


			function renderButtons() {
			$("#buttons-view").empty();
			for (var i = 0; i < giphyContainer.length; i++) {
				var a = $("<button>");
				a.addClass("giphy");
				a.attr("data-name", giphyContainer[i]);
				a.text(giphyContainer[i]);
				$("#buttons-view").append(a);
				}
			}

			$("#add-giphy").on("click", function(event) {
				event.preventDefault();

				var giphy = $("#giphy-input").val().trim();
				giphyContainer.push(giphy);

				renderButtons();
			});
      $(document).on("click", ".giphy", displayGiphy);

			renderButtons();

		</script>	
	</div>
</body>
</html>